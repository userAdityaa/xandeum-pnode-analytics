// Watched pNodes
model Watch {
    id        String   @id @default(cuid())
    ip        String
    createdAt DateTime @default(now())

    @@index([ip])
    @@index([createdAt])
}
// This is your Prisma schema file

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

// Snapshots for network health tracking
model Snapshot {
    id                 String   @id @default(cuid())
    timestamp          BigInt
    networkHealth      Float
    activeNodes        Int
    totalNodes         Int
    riskScore          Float
    riskLevel          String
    outdatedNodes      Int
    outdatedPercentage Float
    createdAt          DateTime @default(now())

    @@index([timestamp])
    @@index([createdAt])
}

// Pod storage data
model PodStorage {
    address             String   @id
    isPublic            Boolean
    lastSeenTimestamp   BigInt
    pubkey              String
    rpcPort             Int
    storageCommitted    BigInt
    storageUsagePercent Float
    storageUsed         BigInt
    uptime              BigInt
    version             String
    credits             Float    @default(0)
    updatedAt           DateTime @updatedAt
    createdAt           DateTime @default(now())

    @@index([updatedAt])
    @@index([isPublic])
}

// Node statistics
model NodeStats {
    address         String   @id
    cpuPercent      Float?
    ramUsed         BigInt?
    ramTotal        BigInt?
    activeStreams   Int?
    packetsReceived BigInt?
    packetsSent     BigInt?
    lastFetched     BigInt
    updatedAt       DateTime @updatedAt
    createdAt       DateTime @default(now())

    @@index([lastFetched])
    @@index([updatedAt])
}

// Geo location cache
model GeoLocation {
    ip        String   @id
    latitude  Float
    longitude Float
    city      String?
    region    String?
    country   String
    timezone  String?
    updatedAt DateTime @updatedAt
    createdAt DateTime @default(now())

    @@index([updatedAt])
}
